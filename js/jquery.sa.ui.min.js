/**
 * @Author Angus <angusyoung@mrxcool.com>
 * @Description Sa UI.js
 * @Since 16/7/24
 */
if("undefined"==typeof $&&"undefined"==typeof jQuery)throw"SaUI need jQuery";$(function(){function e(){var o=$('.nav[role="menu"]').eq(0),t=o.data("width"),n=document.documentElement.clientWidth;n<t&&o.addClass("nav-mini-menu"),$(window).off("resize.menu").on("resize.menu",e)}console.info("\t\t┏━━━┓    ┏┓ ┏┓┏━━┓\n\t\t┃┏━┓┃    ┃┃ ┃┃┗┫┣┛\n\t\t┃┗━━┓┏━━┓┃┃ ┃┃ ┃┃\n\t\t┗━━┓┃┃┏┓┃┃┃ ┃┃ ┃┃\n\t\t┃┗━┛┃┃┏┓┃┃┗━┛┃┏┫┣┓\n\t\t┗━━━┛┗┛┗┛┗━━━┛┗━━┛"),$("body").on("click touchend",".dropdown:not(.dropdown-open)",function(){return $(".dropdown[open]").removeClass("dropdown-open"),$(this).attr("open",!0).addClass("dropdown-open"),!1}).on("click touchend",".dropdown.dropdown-open",function(){$(this).removeClass("dropdown-open")}).on("click touchend",function(){$(".dropdown[open]").removeClass("dropdown-open").removeAttr("open")}).on("click",'[role="dialog"]',function(){var e=$(this),o=e.data("type")||"",t=e.data("title")||"",n=e.data("content")||"",i=e.data("event")||"",a=(e.data("size")||",").split(",");switch(o.toLowerCase()){case"alert":$("<div>"+n+"</div>").dialog({type:"alert",onClose:i?window[i]:null,closeType:"dismiss",width:a[0]||300,height:a[1]||100});break;case"confirm":$("<div>"+n+"</div>").dialog({type:"confirm",onClose:i?window[i]:null,closeType:"dismiss",width:a[0],height:a[1]||100});break;default:var l=e.data("custom");$(l).dialog({close:!0,animate:!0,maskClose:!0,onClose:i?window[i]:null,title:t,width:a[0],height:a[1]})}}).on("mouseenter",'[role="tooltip"]',function(){var e=$(this);e.attr("data-active",!0);var o=e.next(".tooltip");switch(e.data("placement")){case"top":o.css({top:e.offset().top-o.outerHeight(!0),left:e.offset().left+e.outerWidth()/2-o.outerWidth()/2});break;case"bottom":o.css({top:e.offset().top+e.outerHeight(),left:e.offset().left+e.outerWidth()/2-o.outerWidth()/2});break;case"left":o.css({left:e.offset().left-o.outerWidth(!0),top:e.offset().top+e.outerHeight()/2-o.outerHeight()/2});break;case"right":o.css({left:e.offset().left+e.outerWidth(),top:e.offset().top+e.outerHeight()/2-o.outerHeight()/2})}}).on("mouseleave",'[role="tooltip"]',function(){$(this).removeAttr("data-active")}).on("click",'.nav-menu.nav-mini-menu [role="menu-toggle"]',function(){var e=$(this).closest('.nav-menu[role="menu"]');return e.length&&e.addClass("open-menu").selfScroll(),!1}).on("click touchend",function(e){var o=$(e.target).closest('.nav-menu.open-menu[role="menu"]');o.length||$('.nav-menu.open-menu[role="menu"]').removeClass("open-menu")}).on("click",'.nav-menu.open-menu[role="menu"] a',function(){$('.nav-menu.open-menu[role="menu"]').removeClass("open-menu")}),e()}),function(e){e.fn.selfScroll=function(){var e,o,t=this;return t.off("touchstart touchend touchmove").on("touchstart touchend",function(t){t.touches.length&&(e=t.touches[0].clientX,o=t.touches[0].clientY)}).on("touchmove",function(e){var t=e.touches[0];t.clientY-o>0?0===this.scrollTop&&e.preventDefault():this.scrollTop+this.offsetHeight===this.scrollHeight&&e.preventDefault()}),t},e.fn.dialog=function(o){var t=this;if(!t.length)throw new Error("Dialog is dismissed");var n=t.data("dialog");if("string"==typeof o){if(n&&n.length){var i={show:function(){var o,t=this;t.data("config").modal&&(o=e(".dialog-mask"),o.length||(o=e('<div class="dialog-mask"></div>').appendTo("body"))),t.css({position:"fixed",left:document.documentElement.clientWidth/2-this.outerWidth()/2,top:Math.max(0,document.documentElement.clientHeight/2-this.outerHeight()/2)}).show(),a.call(t,o)},hide:function(){var e=this;e.hasClass("dialog-animate")?(e.addClass("dialog-close"),setTimeout(function(){e.removeClass("dialog-close").hide()},600)):e.hide()},dismiss:function(){var e=this;e.hasClass("dialog-animate")?(e.addClass("dialog-close"),setTimeout(function(){e.removeClass("dialog-close").remove()},600)):e.remove()}},a=function(e){var o=this,n=o.data("config");o.off("click close.dialog").on("close.dialog",function(o,i){e&&e.remove(),t.dialog(n.closeType),n.onClose&&"function"==typeof n.onClose&&n.onClose(i)}).on("click",".close",function(){o.trigger("close.dialog",["close"])}).on("click",'a.btn[role="done"]',function(){o.trigger("close.dialog",["done"])}).on("click",'a.btn[role="cancel"]',function(){o.trigger("close.dialog",["cancel"])}),n.maskClose&&e.on("click",function(){o.trigger("close.dialog",["mask"])}),n.autoClose&&setTimeout(function(){o.trigger("close.dialog",["auto"])},n.autoClose)};"function"==typeof i[o]&&i[o].call(n)}}else if("object"==typeof o){o=jQuery.extend({modal:!0,close:!1,animate:!1,maskClose:!1,moveable:!1,autoShow:!0,autoClose:0,closeType:"hide",type:"",title:"",width:300,height:100},o);var l=n&&n.length;if(!l){var s,d="",c=e('<div class="dialog-content"></div>');if((o.title||o.close)&&(d='<div class="dialog-head">'+(o.close?'<a aria-label="Close" class="close"><i aria-hidden="true">&times;</i></a>':"")+(o.title?"<h3>"+o.title+"</h3>":"")+"</div>"),c.append(t),o.type)switch(s=e('<div class="dialog-foot"></div>'),o.type){case"alert":s.append('<a role="cancel" class="btn btn-primary">确定</a>');break;case"confirm":s.append('<a role="done" class="btn btn-primary">确定</a><a role="cancel" class="btn btn-default">取消</a>')}var r=e("<div></div>").addClass("dialog").addClass(o.title?"":"dialog-untitled").addClass(o.animate?"dialog-animate":"").css({display:"none",width:o.width}).data("config",o).append(d).append(c.css({height:Math.min(o.height,.9*document.documentElement.clientHeight)})).append(s).appendTo("body");t.data("dialog",r)}o.autoShow&&t.dialog("show")}return t}}(jQuery);