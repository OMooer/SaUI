/**
 * @License
 * @Author Angus <angusyoung@mrxcool.com>
 * @Description Sa.UI.js for jQuery
 * @Since 16/7/24
 */
!function(t,e){"function"==typeof define&&define.amd?define(["$"],e):"undefined"!=typeof module?module.exports=e(require("$")):t.saui=e(t.$)}(this,function($){if(void 0===$)throw"SaUI need jQuery";function Calendar(t){this.id=Math.random().toString().substr(2),this.$el=$(t),this.options=this.getOption(),this.resetDate();var e,t=this.$parent=$('<div class="date-panel card">  <div class="pull-left">     <a href="#" title="'+this.options.prevYear+'" role-action="prevYear"><i class="sa-icon sa-icon-fw sa-icon-angle-double-left"></i></a>     <a href="#" title="'+this.options.prevMonth+'" role-action="prevMonth"><i class="sa-icon sa-icon-fw sa-icon-angle-left"></i></a>  </div>  <div class="pull-right">     <a href="#" title="'+this.options.nextMonth+'" role-action="nextMonth"><i class="sa-icon sa-icon-fw sa-icon-angle-right"></i></a>     <a href="#" title="'+this.options.nextYear+'" role-action="nextYear"><i class="sa-icon sa-icon-fw sa-icon-angle-double-right"></i></a>  </div></div>');this.$container=$('<div class="calendar card-body"></div>'),this.$container.appendTo(t),this.options.autoClose||(e='<form class="form card-foot">'+(this.options.allowEdit?this.options.isRange?'<div class="pull-left">'+(this.options.showTime?'  <input type="datetime-local"'+(this.options.showSecond?' step="1"':"")+(this.options.min?' min="'+this.options.min+'"':"")+(this.options.max?' max="'+this.options.max+'"':"")+' value="'+this.startDate+"T"+this.selectStartTime+'">-  <input type="datetime-local"'+(this.options.showSecond?' step="1"':"")+(this.options.min?' min="'+this.options.min+'"':"")+(this.options.max?' max="'+this.options.max+'"':"")+' value="'+this.endDate+"T"+this.selectEndTime+'">':'  <input type="date"'+(this.options.min?' min="'+this.options.min+'"':"")+(this.options.max?' max="'+this.options.max+'"':"")+' value="'+this.startDate+'">-  <input type="date"'+(this.options.min?' min="'+this.options.min+'"':"")+(this.options.max?' max="'+this.options.max+'"':"")+' value="'+this.endDate+'">')+'  <span class="bg-error">'+this.options.errorText+"</span></div>":this.options.showTime?'<div class="pull-left">  <input type="time"'+(this.options.showSecond?' step="1"':"")+' value="'+this.selectStartTime+'"></div>':"":"")+'  <div class="pull-right">'+(this.options.todayBtn?'<button type="button" role-action="today">'+this.options.todayText+"</button>":"")+'     <button type="button" class="btn btn-primary" role-action="update">'+this.options.doneText+"</button>  </div></form>",t.append(e)),this.init()}$(function(){console.info("\t\t┏━━━┓    ┏┓ ┏┓┏━━┓\n\t\t┃┏━┓┃    ┃┃ ┃┃┗┫┣┛\n\t\t┃┗━━┓┏━━┓┃┃ ┃┃ ┃┃ \n\t\t┗━━┓┃┃┏┓┃┃┃ ┃┃ ┃┃ \n\t\t┃┗━┛┃┃┏┓┃┃┗━┛┃┏┫┣┓\n\t\t┗━━━┛┗┛┗┛┗━━━┛┗━━┛"),$("body").off("ready").on("tap",".dropdown",function(t,e){e?($(".dropdown[open]").removeClass("dropdown-open").removeAttr("open"),$(this).attr("open",!0).addClass("dropdown-open")):$(this).removeClass("dropdown-open")}).on("touchstart",".dropdown:not(.dropdown-open)",function(){$(this).data("touchTime",(new Date).getTime())}).on("touchend",".dropdown:not(.dropdown-open)",function(){if((new Date).getTime()-$(this).data("touchTime")<300)return $(this).trigger("tap",[!0]),!1}).on("click",".dropdown:not(.dropdown-open)",function(){return $(this).trigger("tap",[!0]),!1}).on("click touchend",".dropdown.dropdown-open",function(){$(this).trigger("tap")}).on("click touchend",".dropdown.dropdown-open .dropdown-head,.dropdown.dropdown-open .dropdown-disabled,.dropdown.dropdown-open .dropdown-divider",function(){return!1}).on("click touchend",function(t){$(".dropdown[open]").removeClass("dropdown-open").removeAttr("open");t=$(t.target).closest('[role="calendar"]'),t=$('[role="calendar"][open]').not(t).data("op");t&&t.dismiss()}).on("click",'[role="dialog"]',function(){var t=$(this),e=t.data("type")||"",i=t.data("title")||"",n=t.data("content")||"",o=t.data("event")||"",a=(t.data("size")||",").split(",");switch(e.toLowerCase()){case"alert":$("<div>"+n+"</div>").dialog({type:"alert",onClose:o?window[o]:null,closeType:"dismiss",width:a[0]||300,height:a[1]||100});break;case"confirm":$("<div>"+n+"</div>").dialog({type:"confirm",onClose:o?window[o]:null,closeType:"dismiss",width:a[0],height:a[1]||100});break;default:var s=t.data("custom");$(s).dialog({close:!0,animate:!0,maskClose:!0,onClose:o?window[o]:null,title:i,width:a[0],height:a[1]})}}).on("mouseenter",'[role="tooltip"]',function(){var t=$(this),e=(t.attr("data-active",!0),t.next(".tooltip"));switch(t.data("placement")){case"top":e.css({top:t.offset().top-e.outerHeight(!0),left:t.offset().left+t.outerWidth()/2-e.outerWidth()/2});break;case"bottom":e.css({top:t.offset().top+t.outerHeight(),left:t.offset().left+t.outerWidth()/2-e.outerWidth()/2});break;case"left":e.css({left:t.offset().left-e.outerWidth(!0),top:t.offset().top+t.outerHeight()/2-e.outerHeight()/2});break;case"right":e.css({left:t.offset().left+t.outerWidth(),top:t.offset().top+t.outerHeight()/2-e.outerHeight()/2})}}).on("mouseleave",'[role="tooltip"]',function(){$(this).removeAttr("data-active")}).on("touchend",'.nav-menu.nav-mini-menu [role="menu-toggle"]',function(){var t=$(this).closest('.nav-menu[role="menu"]');return t.length&&t.addClass("open-menu").selfScroll(),!1}).on("touchstart",function(t){$(t.target).closest('.nav-menu.open-menu[role="menu"]').length||$('.nav-menu.open-menu[role="menu"]').removeClass("open-menu")}).on("click",'.nav-menu.open-menu[role="menu"] a',function(){$('.nav-menu.open-menu[role="menu"]').removeClass("open-menu")}).on("click",'[role="calendar"]:not([open])',function(){new Calendar(this)}),function t(){var e=$('.nav[role="menu"]').eq(0),i=e.data("width");document.documentElement.clientWidth<i?e.addClass("nav-mini-menu"):e.removeClass("nav-mini-menu"),$(window).off("resize.menu").on("resize.menu",t)}()}),$.fn.selfScroll=function(){var e;return this.off("touchstart touchend touchmove").on("touchstart touchend",function(t){t.touches.length&&(t.touches[0].clientX,e=t.touches[0].clientY)}).on("touchmove",function(t){0<t.touches[0].clientY-e?0===this.scrollTop&&t.preventDefault():this.scrollTop+this.offsetHeight===this.scrollHeight&&t.preventDefault()}),this},$.fn.dialog=function(t){var n=this;if(!n.length)throw new Error("Dialog is dismissed");var e=n.data("dialog");if("object"==typeof t){var i=$.extend({modal:!0,close:!1,animate:!1,maskClose:!1,moveable:!1,autoShow:!0,autoClose:0,closeType:"hide",type:"",title:"",doneText:"确定",cancelText:"取消",width:300,height:100},t);if(!(e&&e.length)){var o,a,s=$('<div class="dialog-body"></div>');if((i.title||i.close)&&(r=$('<div class="dialog-head"></div>'),i.close&&r.append('<a aria-label="Close" class="close"><i aria-hidden="true">&times;</i></a>'),i.title)&&r.append("<h3>"+i.title+"</h3>"),s.append(n),i.type)switch(o=$('<div class="dialog-foot"></div>'),i.type){case"alert":o.append('<a role="cancel" class="btn btn-primary">'+i.doneText+"</a>");break;case"confirm":o.append('<a role="done" class="btn btn-primary">'+i.doneText+'</a><a role="cancel" class="btn btn-default">'+i.cancelText+"</a>")}i.modal&&(a=$('<div class="dialog-mask"></div>'));var r=$("<div></div>").addClass("dialog-container").addClass(i.title?"":"dialog-untitled").addClass(i.animate?"dialog-animate":"").css({width:i.width}).append(r).append(s.css({height:Math.min(i.height,.9*document.documentElement.clientHeight)})).append(o),s=$("<div></div>").addClass("dialog").css({display:"none"}).data("config",i).append(a).append(r).appendTo("body");n.data("dialog",s)}i.autoShow&&n.dialog("show")}else"string"==typeof t&&e&&e.length&&(a={show:function(){this.show();var i,t=this.children(".dialog-container");t.css({position:"fixed"}),t.css({left:document.documentElement.clientWidth/2-t.outerWidth()/2,top:Math.max(0,document.documentElement.clientHeight/2-t.outerHeight()/2)}),i=e.data("config"),e.off().on("close.dialog",function(t,e){n.dialog(i.closeType),i.onClose&&"function"==typeof i.onClose&&i.onClose(e)}).on("click",".close",function(){e.trigger("close.dialog",["close"])}).on("click",'a.btn[role="done"]',function(){e.trigger("close.dialog",["done"])}).on("click",'a.btn[role="cancel"]',function(){e.trigger("close.dialog",["cancel"])}).on("click",".dialog-mask",function(){i.maskClose&&e.trigger("close.dialog",["mask"])}),i.autoClose&&setTimeout(function(){e.trigger("close.dialog",["auto"])},i.autoClose)},hide:function(){var t=this,e=t.children(".dialog-container");e.hasClass("dialog-animate")?(e.addClass("dialog-close"),setTimeout(function(){e.removeClass("dialog-close"),t.hide()},600)):t.hide()},dismiss:function(){var t=this,e=t.children(".dialog-container");e.hasClass("dialog-animate")?(e.addClass("dialog-close"),setTimeout(function(){t.remove()},600)):t.remove()}})[t]&&a[t].call(e);return n},Calendar.prototype={start:!0,startDate:"2000-01-01",endDate:"2000-01-01",selectStartTime:"08:00:00",selectEndTime:"08:00:00",cenMonth:0,preMonth:0,__check_version:function(){var t=navigator.userAgent.toLowerCase();return-1<t.indexOf("firefox")?"Firefox":-1<t.indexOf("chrome")?"Chrome":-1<t.indexOf("safari")?"Safari":"Other"},__date_string:function(t,e){var i=new Date(t);switch(e){case"D":return i.toLocaleString("nu",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-");case"T":return i.toLocaleString("nu",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}},__format_string:function(t,n){return t.replace(/^\d{4}-[01]\d-[0123]\d(T[012][0123]:[0-5]\d:[0-5]\d)?$/,function(t,e){var t=new Date(t),i=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+"T";return i+=e?("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2):n||"00:00:00"})},__prefix:function(t){var e;return t?(0<t.indexOf(" ")&&((t=t.split(" ").join("T")).length<16&&(t+=":00"),"Safari"===this.__check_version())&&(t+=0<(e=Math.round((new Date).getTimezoneOffset()/60))?"-"+("0"+e).slice(-2)+":00":"+"+("0"+Math.abs(e)).slice(-2)+":00"),t):""},init:function(){this.refresh(),this.$el.data("op",this).attr("open",!0).blur(),this.options.allowEdit||(this.options.rangeEl&&this.options.rangeEl.length?$(this.options.rangeEl[0]).is("input")&&($(this.options.rangeEl[0]).prop("readonly",!0),$(this.options.rangeEl[1]).prop("readonly",!0)):this.$el.prop("readonly",!0)),this.$parent.appendTo(document.body).css({left:this.$el.offset().left,top:this.$el.offset().top+this.$el.outerHeight()}).fadeOut(0).fadeIn(),this.bindEvent()},resetDate:function(){var t=this.options.date;t instanceof Array?(this.startDate=this.__date_string(t[0],"D"),this.endDate=this.__date_string(t[1],"D")):this.startDate=this.__date_string(t,"D"),this.options.showTime&&(this.options.isRange?(this.selectStartTime=this.__date_string(t[0],"T"),this.selectEndTime=this.__date_string(t[1],"T")):this.selectStartTime=this.selectEndTime=this.__date_string(t,"T"),this.options.showSecond||(this.selectStartTime=this.selectStartTime.split(":").slice(0,2).join(":"),this.selectEndTime=this.selectEndTime.split(":").slice(0,2).join(":"))),this.options.isRange?this.cenMonth=new Date(this.endDate).setDate(1):this.cenMonth=new Date(this.startDate).setDate(1)},getOption:function(){var _option={weekStart:0,language:navigator.language||"en",allowEdit:!1,autoClose:!1,todayBtn:!1,date:(new Date).setHours(8,0,0,0),todayText:"今天",doneText:"确定",errorText:"日期格式填写错误",prevYear:"上一年",nextYear:"下一年",prevMonth:"上一月",nextMonth:"下一月"};if(this.$el.attr("data-language")&&(_option.language=this.$el.attr("data-language")),this.$el.attr("data-lang-pack")){var pack=this.$el.attr("data-lang-pack");if("string"==typeof pack)try{eval("(pack="+pack+")")}catch(e){pack={}}_option.doneText=pack.doneText||_option.doneText,_option.todayText=pack.todayText||_option.todayText,_option.errorText=pack.errorText||_option.errorText,_option.prevYear=pack.prevYear||_option.prevYear,_option.nextYear=pack.nextYear||_option.nextYear,_option.prevMonth=pack.prevMonth||_option.prevMonth,_option.nextMonth=pack.nextMonth||_option.nextMonth}this.$el.attr("data-range")&&(_option.isRange=!0),(this.$el.is('[type="datetime-local"]')||this.$el.attr("data-show-time")||2===this.$el.find('input[type="datetime-local"]').length)&&(_option.showTime=!0),(_option.showTime&&this.$el.prop("step")&&this.$el.prop("step")<60||2===this.$el.find('input[type="datetime-local"][step]').length)&&(_option.showSecond=!0);var sMin=this.$el.prop("min")?this.$el.prop("min"):this.$el.attr("data-min"),sMax=(sMin&&(_option.min=this.__format_string(sMin)),this.$el.prop("max")?this.$el.prop("max"):this.$el.attr("data-max")),_input,_start,_end;return sMax&&(_option.max=this.__format_string(sMax,"23:59:59")),_option.allowEdit=!!this.$el.attr("data-editable"),_option.isRange||_option.allowEdit||!this.$el.attr("data-auto-close")||(_option.autoClose=!0),_option.isRange?(_input=this.$el.find("input"),_input.length?_option.rangeEl=$.map(_input,function(t){return $(t).attr("min",_option.min).attr("max",_option.max),t}):_option.rangeEl=$.map(this.$el.find('[role="range"]'),function(t){return t}),_start=new Date(this.__prefix(_option.rangeEl[0].value||_option.rangeEl[0].innerText)).getTime()||(new Date).getTime(),_end=new Date(this.__prefix(_option.rangeEl[1].value||_option.rangeEl[1].innerText)).getTime()||(new Date).getTime(),_option.date=[_start,_end]):_option.date=new Date(this.__prefix(this.$el.val()||this.$el.text())).getTime()||(new Date).getTime(),this.$el.attr("data-week-start")&&(_option.weekStart=this.$el.attr("data-week-start"),7<_option.weekStart)&&(_option.weekStart=0),_option.weekStart=_option.weekStart%7,_option.todayBtn=!!this.$el.attr("data-today"),_option},bindEvent:function(){var e=this;this.$el.off("change").on("change",function(t){t=t.target;e.options.isRange?t===e.options.rangeEl[0]?e.options.date[0]=new Date(e.__prefix(t.value)).getTime():t===e.options.rangeEl[1]&&(e.options.date[1]=new Date(e.__prefix(t.value)).getTime()):e.options.date=new Date(e.__prefix(t.value)).getTime(),e.resetDate(),e.refresh()}),this.$parent.on("click",function(){return!1}).on("change",'input[type*="date"]',function(){$(this).is(":first-of-type")?(e.startDate=e.__date_string(this.value,"D"),e.selectStartTime=e.__date_string(this.value,"T")):$(this).is(":last-of-type")&&(e.endDate=e.__date_string(this.value,"D"),e.selectEndTime=e.__date_string(this.value,"T")),e.refresh()}).on("change",'[type="time"]',function(){e.selectStartTime=this.value}).on("click","[role-action]",function(){var t=$(this).attr("role-action");"function"==typeof e[t]&&e[t]()}).on("click","ul>li",function(){var t=$(this).data("date");t&&(t=e.__date_string(t,"D"),e.start||!e.options.isRange?(e.startDate=e.endDate=t,e.start=!1):(e.endDate=t,e.start=!0),new Date(e.endDate)<new Date(e.startDate)&&(t=e.startDate,e.startDate=e.endDate,e.endDate=t),e.options.autoClose?e.update():e.refresh())})},dismiss:function(){this.$el.removeAttr("open").removeData("op"),this.$parent.fadeOut(function(){$(this).remove()})},update:function(){var t=this.startDate,e=this.endDate;this.options.showTime&&(t+="T"+this.selectStartTime,e+="T"+this.selectEndTime),this.options.isRange?$(this.options.rangeEl[0]).is("input")?(this.options.rangeEl[0].value=t,this.options.rangeEl[1].value=e):(this.options.rangeEl[0].innerHTML=t.replace("T"," "),this.options.rangeEl[1].innerHTML=e.replace("T"," ")):this.$el.is("input")?this.$el.is('[type*="date"]')?this.$el.val(t):this.$el.val(t.replace("T"," ")):this.$el.html(t.replace("T"," ")),this.$el[0].dispatchEvent(new CustomEvent("change",{detail:{start:t,end:e}})),this.dismiss()},prevYear:function(){var t=new Date(this.cenMonth);this.cenMonth=t.setFullYear(t.getFullYear()-1),this.refresh()},prevMonth:function(){var t=new Date(this.cenMonth);this.cenMonth=t.setMonth(t.getMonth()-1),this.refresh()},nextYear:function(){var t=new Date(this.cenMonth);this.cenMonth=t.setFullYear(t.getFullYear()+1),this.refresh()},nextMonth:function(){var t=new Date(this.cenMonth);this.cenMonth=t.setMonth(t.getMonth()+1),this.refresh()},today:function(){this.cenMonth=(new Date).setDate(1),this.refresh()},refresh:function(){var t="",e=this.options.language,i=this.options.isRange?[this.startDate,this.endDate]:[this.startDate,this.startDate];this.options.isRange&&(this.preMonth=new Date(new Date(this.cenMonth).setDate(0)).setDate(1),t+="\t\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t\t<dt>"+new Date(this.preMonth).toLocaleString(e,{year:"numeric",month:"long"})+"</dt>\t\t\t\t\t\t\t\t<dd>"+this.write(this.preMonth,i)+"</dd>\t\t\t\t\t\t\t</dl>"),t+="\t\t\t\t\t\t<dl>\t\t\t\t\t\t\t<dt>"+new Date(this.cenMonth).toLocaleString(e,{year:"numeric",month:"long"})+"</dt>\t\t\t\t\t\t\t<dd>"+this.write(this.cenMonth,i)+"</dd>\t\t\t\t\t\t</dl>",this.$container.html(t),!this.options.autoClose&&this.options.allowEdit&&(this.options.isRange?(e=this.$parent.find("form input"),this.options.showTime?(e.eq(0).val(this.startDate+"T"+this.selectStartTime),e.eq(1).val(this.endDate+"T"+this.selectEndTime)):(e.eq(0).val(this.startDate),e.eq(1).val(this.endDate))):this.$parent.find("form input").val(this.selectStartTime))},write:function(t,e){for(var i=this.options.language,n=(e[0]=new Date(e[0]).setHours(0,0,0,0),e[1]=new Date(e[1]).setHours(0,0,0,0),new Date(this.options.min).getTime()||0),o=new Date(this.options.max).getTime()||636304608e5,t=new Date(t),a=t.getFullYear(),s=t.getMonth(),r=[12438144e5,12439008e5,12439872e5,12440736e5,124416e7,12442464e5,12443328e5],l=[2,3,4,5,6,7,1],h=(l=[].concat(l.slice(-this.options.weekStart),l.slice(0,l.length-(this.options.weekStart||7))))[(t.getDay()||7)-1]-1,d=new Date(a,s+1,0).getDate(),p=[],c=0;c<d;c++)p[h+c]=c+1;var u=[],t=($.each(l,function(t,e){u[e-1]=new Date(r[t]).toLocaleString(i,{weekday:"short"})}),7*u[0].replace(/\w{2}/g,"@").length+2),m='<ol style="width:'+t+'em; min-width: 16em;"><li>'+u.join("</li><li>")+"</li></ol>";for(m+='<ul style="width:'+t+'em; min-width: 16em;">',c=0;c<p.length;c++){var g,f,v,w=p[c];w?(f=[],v=' data-date="'+(g=new Date(a,s,w)).getTime()+'"',(new Date).setHours(0,0,0,0)===g.getTime()&&f.push("today"),g.getTime()>=e[0]&&g.getTime()<=e[1]&&(f.push("selected"),g.getTime()===e[1]?f.push("last-of"):g.getTime()===e[0]&&f.push("first-of")),(o&&new Date(o).setHours(0,0,0,0)<g.getTime()||n&&new Date(n).setHours(0,0,0,0)>g.getTime())&&(f.push("disabled"),v=""),f=f.length?' class="'+f.join(" ")+'"':"",m+='<li title="'+g.toLocaleString(i,{year:"numeric",month:"long",day:"numeric"})+'"'+v+f+">"+w+"</li>"):m+="<li></li>"}return m+="</ul>"}}});